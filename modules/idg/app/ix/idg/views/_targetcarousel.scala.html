@import ix.ncats.controllers.App
@import ix.idg.models.Target
@import ix.idg.controllers.IDGApp
@import ix.idg.controllers.Commons._
@import ix.ncats.controllers.App.FacetDecorator
@import ix.core.search.TextIndexer._
@import ix.utils.Util

@(ctx: SearchResult)

@donut(f: Facet) = {
  @if(f != null) {
     new Morris.Donut({
        element: '@Util.sha1(f.getName())',
        data: [
          @for(v <- f.getValues()) {
	    {label: '@v.getLabel',
	     value: @v.getCount},
	  }
        ]
     }).on('click',function (i,data) {
        console.log('i='+i+' data='+data.label);
        var uri = '@HtmlFormat.raw(request.uri)';
        uri += (uri.indexOf('?') > 0 ? '&' : '?')
           + 'facet=@f.getName()'+'/'+data.label;
        location.assign(uri);
     });
  } @*else {
    new Morris.Donut({
       element: 'empty-donut',
       data: [
         {label: 'None', value: 1}
       ]
    });
  }*@
}

@carouselitem(f: Facet, caption: String) = {
        <div class="container-fluid">
	    <div class="row">
	      <div class="col-md-12">
	         <div class="col-xs-3 col-md-4"></div>
		 <div class="col-xs-3 col-md-4">
	             <div style="height: 200px; width: 200px;"
		       @if(f != null) {
	     	     	  id="@Util.sha1(f.getName)"
		       } else {
		          id="empty-donut"
		       }
		       ></div>
		 </div>
	      </div>
	    </div>
	    <div class="row">
    	      <div class="col-md-12">
	        <center><h4>@caption</h4></center>
	      </div>
	    </div>
	</div>
}

<div class="collapse" id="carousel-highlight">
  <div id="target-carousel" class="carousel slide"
       data-ride="carousel" data-interval="false">
    <!-- Indicators -->
    <ol class="carousel-indicators">
      <li data-target="#target-carousel" data-slide-to="0" class="active"></li>
      <li data-target="#target-carousel" data-slide-to="1"></li>
      <li data-target="#target-carousel" data-slide-to="2"></li>
      <li data-target="#target-carousel" data-slide-to="3"></li>
      <li data-target="#target-carousel" data-slide-to="4"></li>
      <li data-target="#target-carousel" data-slide-to="5"></li>
    </ol>
    
    <!-- Wrapper for slides -->
    <div class="carousel-inner" role="listbox">
      <div class="item active">
         @carouselitem(ctx.getFacet(IDG_DEVELOPMENT), "Distribution of target development level")
      </div>
      <div class="item">
         @carouselitem(ctx.getFacet(IDG_FAMILY), "Distribution of target family")
      </div>
      <div class="item">
         @carouselitem(ctx.getFacet(IDG_TISSUE), "Distribution of annotated tissues")
      </div>
      <div class="item">
         @carouselitem(ctx.getFacet(IDG_LIGAND), "Distribution of ligands")
      </div>
      <div class="item">
         @carouselitem(ctx.getFacet(PANTHER_PROTEIN_CLASS+" (3)"), "Distribution of PANTHER protein classes")	 
      </div>
      <div class="item">
         @carouselitem(ctx.getFacet(MGI_TERM), "Distribution of JAX/MGI phenotype")
      </div>      
    </div>
    
    <!-- Controls -->
    <a class="left carousel-control" href="#target-carousel" role="button" data-slide="prev">
      <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="right carousel-control" href="#target-carousel" role="button" data-slide="next">
      <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
      <span class="sr-only">Next</span>
    </a>
  </div>
</div>

<script>
$(document).ready(function () {
@donut(ctx.getFacet(IDG_DEVELOPMENT))
@donut(ctx.getFacet(IDG_FAMILY))
@donut(ctx.getFacet(IDG_TISSUE))
@donut(ctx.getFacet(IDG_LIGAND))
@donut(ctx.getFacet(PANTHER_PROTEIN_CLASS+" (3)"))
@donut(ctx.getFacet(MGI_TERM))
});
</script>

